# ğŸš€ ProductHunt è‡ªåŠ¨å¯¼å…¥å®Œæ•´æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

è‡ªåŠ¨ä» ProductHunt è·å–æ¯æ—¥ Top 5 äº§å“å¹¶å¯¼å…¥åˆ° aat.eeï¼Œä½¿ç”¨ bot è´¦å·æ¨¡æ‹Ÿä¸åŒç”¨æˆ·æäº¤ã€‚

### âœ¨ ç‰¹æ€§

- âœ… æ¯å¤©è‡ªåŠ¨å¯¼å…¥ ProductHunt Top 5 äº§å“
- âœ… ä½¿ç”¨ 5 ä¸ªä¸åŒçš„ bot è´¦å·æ¨¡æ‹ŸçœŸå®ç”¨æˆ·
- âœ… æ™ºèƒ½å»é‡ï¼ˆé¿å…é‡å¤å¯¼å…¥ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆ slug å’Œå¤„ç†å†²çª
- âœ… è¯¦ç»†æ—¥å¿—è®°å½•
- âœ… ä½¿ç”¨ Linux Cron å®šæ—¶æ‰§è¡Œ
- âœ… å®‰å…¨çš„ API è®¤è¯æœºåˆ¶

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Linux Cron Job                           â”‚
â”‚              æ¯å¤© UTC 01:00 è‡ªåŠ¨æ‰§è¡Œ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          scripts/cron-import-producthunt.sh                â”‚
â”‚              (Shell è„šæœ¬ + Bearer Token è®¤è¯)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       /api/cron/import-producthunt (Next.js API)           â”‚
â”‚              (éªŒè¯ CRON_SECRET + ä¸šåŠ¡é€»è¾‘)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           lib/producthunt.ts (API Client)                  â”‚
â”‚              (è°ƒç”¨ ProductHunt GraphQL API)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®åº“æ“ä½œ                                 â”‚
â”‚   1. æ£€æŸ¥æ˜¯å¦å·²å¯¼å…¥ (product_hunt_import è¡¨)               â”‚
â”‚   2. é€‰æ‹© bot ç”¨æˆ· (user è¡¨, is_bot=true)                  â”‚
â”‚   3. åˆ›å»ºé¡¹ç›® (project è¡¨)                                  â”‚
â”‚   4. è®°å½•å¯¼å…¥ (product_hunt_import è¡¨)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ å®‰è£…æ­¥éª¤

### å‰ç½®è¦æ±‚

- âœ… PostgreSQL æ•°æ®åº“
- âœ… Node.js 18+
- âœ… ProductHunt API Key
- âœ… Cloudflare R2 å­˜å‚¨é…ç½®ï¼ˆç”¨äºå­˜å‚¨ logoï¼‰
- âœ… å®šæ—¶ä»»åŠ¡æœåŠ¡ï¼ˆLinux Cron æˆ–å¤–éƒ¨ Cron æœåŠ¡ï¼‰

---

### æ­¥éª¤ 1: è·å– ProductHunt Developer Token

ProductHunt API v2 ä½¿ç”¨ **Developer Token** è¿›è¡Œè®¤è¯ï¼Œè¯¥ä»¤ç‰Œæ°¸ä¹…æœ‰æ•ˆï¼Œé€‚åˆè‡ªåŠ¨åŒ–è„šæœ¬ã€‚

#### è·å–æ­¥éª¤

1. **ç™»å½• ProductHunt**

   ```
   https://www.producthunt.com/
   ```

2. **è®¿é—® API ç®¡ç†é¡µé¢**

   ```
   https://www.producthunt.com/v2/oauth/applications
   ```

3. **åˆ›å»ºæ–°çš„ OAuth Application**

   - ç‚¹å‡» **"Create an application"**
   - **Application Name**: `aat.ee Auto Import`
   - **Redirect URI**: `https://aat.ee` (æ‚¨çš„ç½‘ç«™ URL)
   - **Description**: `Automatically import top products from ProductHunt`

4. **è·å– Developer Token**

   - åˆ›å»ºæˆåŠŸåï¼Œé¡µé¢ä¼šæ˜¾ç¤º **Developer Token**
   - è¿™ä¸ª Token æ ¼å¼ç±»ä¼¼: `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`
   - **é‡è¦**: ç«‹å³å¤åˆ¶å¹¶ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢åå¯èƒ½æ— æ³•å†æ¬¡æŸ¥çœ‹å®Œæ•´ Token

5. **éªŒè¯ Token**

   ```bash
   curl -H "Authorization: Bearer YOUR_TOKEN_HERE" \
        -H "Content-Type: application/json" \
        -X POST \
        -d '{"query": "{ viewer { id name } }"}' \
        https://api.producthunt.com/v2/api/graphql
   ```

   **é¢„æœŸå“åº”**:

   ```json
   {
     "data": {
       "viewer": {
         "id": "123456",
         "name": "Your Name"
       }
     }
   }
   ```

#### Token ç‰¹ç‚¹

- âœ… **æ°¸ä¹…æœ‰æ•ˆ**: Developer Token ä¸ä¼šè¿‡æœŸ
- âœ… **æ— éœ€ç”¨æˆ·æˆæƒ**: ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€ OAuth æµç¨‹
- âœ… **åªè¯»æƒé™**: é»˜è®¤åªèƒ½è¯»å–å…¬å¼€æ•°æ®
- âœ… **é€‚åˆè„šæœ¬**: ä¸“ä¸ºè‡ªåŠ¨åŒ–åœºæ™¯è®¾è®¡

#### é‡è¦è¯´æ˜

âš ï¸ **å•†ä¸šä½¿ç”¨é™åˆ¶**: ProductHunt API é»˜è®¤ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”ã€‚å¦‚æœæ‚¨çš„é¡¹ç›®å±äºå•†ä¸šæ€§è´¨ï¼Œéœ€è¦ï¼š

1. è”ç³» ProductHunt å®˜æ–¹: api@producthunt.com
2. è¯´æ˜æ‚¨çš„ä½¿ç”¨åœºæ™¯
3. è·å¾—å®˜æ–¹è®¸å¯

å¯¹äºä¸ªäººé¡¹ç›®æˆ–å†…éƒ¨ä½¿ç”¨ï¼ŒDeveloper Token å®Œå…¨è¶³å¤Ÿã€‚

---

### æ­¥éª¤ 2: æ•°æ®åº“è¿ç§»

```bash
# 1. è¿æ¥åˆ°æ•°æ®åº“
psql $DATABASE_URL

# 2. æ‰§è¡Œè¿ç§»
\i drizzle/migrations/add_bot_and_producthunt.sql

# 3. éªŒè¯è¡¨åˆ›å»º
\dt product_hunt_import

# 4. éªŒè¯ bot ç”¨æˆ·
SELECT id, name, email, is_bot FROM "user" WHERE is_bot = true;
```

**é¢„æœŸç»“æœ**ï¼šåº”è¯¥çœ‹åˆ° 5 ä¸ª bot ç”¨æˆ·ï¼š

```
         id          |     name      |       email        | is_bot
---------------------+---------------+--------------------+--------
 bot-user-ph-1       | TechHunter    | bot-ph-1@aat.ee    | t
 bot-user-ph-2       | ProductScout  | bot-ph-2@aat.ee    | t
 bot-user-ph-3       | LaunchTracker | bot-ph-3@aat.ee    | t
 bot-user-ph-4       | StartupDigger | bot-ph-4@aat.ee    | t
 bot-user-ph-5       | InnoFinder    | bot-ph-5@aat.ee    | t
```

---

### æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡

#### 3.1 ç”Ÿäº§ç¯å¢ƒï¼ˆZeabur/Vercelï¼‰

ç™»å½•éƒ¨ç½²å¹³å°ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ï¼š

```bash
# ProductHunt API Key
PRODUCTHUNT_API_KEY=your_producthunt_api_key_here

# Cron Secretï¼ˆç”Ÿæˆéšæœºå¯†é’¥ï¼‰
CRON_SECRET=your_super_secret_cron_key_here

# Cloudflare R2 é…ç½®ï¼ˆç”¨äºå­˜å‚¨ logoï¼‰
R2_ACCOUNT_ID=your_r2_account_id
R2_ACCESS_KEY_ID=your_r2_access_key_id
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key
R2_BUCKET_NAME=your_bucket_name
R2_PUBLIC_DOMAIN=https://your-r2-domain.com
```

**ç”Ÿæˆ CRON_SECRET**:

```bash
openssl rand -base64 32
```

#### 3.2 æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp env.example.txt .env

# ç¼–è¾‘ .env æ–‡ä»¶
nano .env

# æ·»åŠ ä»¥ä¸‹å†…å®¹
PRODUCTHUNT_API_KEY=your_producthunt_api_key
CRON_SECRET=your_cron_secret
```

---

### æ­¥éª¤ 4: æµ‹è¯• API ç«¯ç‚¹

```bash
# æ‰‹åŠ¨è§¦å‘å¯¼å…¥ï¼ˆæµ‹è¯•ï¼‰
curl -X GET \
  -H "Authorization: Bearer YOUR_CRON_SECRET" \
  https://www.aat.ee/api/cron/import-producthunt

# é¢„æœŸå“åº”
{
  "success": true,
  "timestamp": "2025-11-13T10:00:00.000Z",
  "summary": {
    "total": 5,
    "imported": 5,
    "skipped": 0,
    "errors": 0
  },
  "results": [
    {
      "name": "Amazing Product",
      "status": "imported"
    }
  ]
}
```

---

### æ­¥éª¤ 5: é…ç½®å®šæ—¶ä»»åŠ¡

#### âš ï¸ é‡è¦è¯´æ˜

**å¦‚æœæ‚¨ä½¿ç”¨ Zeaburã€Vercelã€Railway ç­‰å®¹å™¨åŒ–éƒ¨ç½²å¹³å°**ï¼Œè¯·å‚è€ƒ **[PRODUCTHUNT_CRON_ZEABUR.md](./PRODUCTHUNT_CRON_ZEABUR.md)** ä½¿ç”¨å¤–éƒ¨ Cron æœåŠ¡ï¼ˆæ¨è cron-job.orgï¼‰ã€‚

å®¹å™¨åŒ–ç¯å¢ƒ**æ— æ³•ç›´æ¥é…ç½®ç³»ç»Ÿ Cron**ï¼Œéœ€è¦ä½¿ç”¨å¤–éƒ¨æœåŠ¡è§¦å‘ APIã€‚

---

#### æ–¹æ¡ˆ A: å¤–éƒ¨ Cron æœåŠ¡ï¼ˆæ¨èï¼Œé€‚ç”¨äº Zeabur/å®¹å™¨ç¯å¢ƒï¼‰

**æ¨èä½¿ç”¨ cron-job.orgï¼ˆå®Œå…¨å…è´¹ï¼‰**:

1. **æ³¨å†Œè´¦å·**

   ```
   https://cron-job.org/
   ```

2. **åˆ›å»º Cron Job**

   - **URL**: `https://www.aat.ee/api/cron/import-producthunt`
   - **Schedule**: æ¯å¤© 01:00 UTC
   - **Request method**: GET
   - **Headers**:
     ```
     Authorization: Bearer YOUR_CRON_SECRET
     ```

3. **æµ‹è¯•æ‰§è¡Œ**
   ç‚¹å‡» "Run now" éªŒè¯é…ç½®

**è¯¦ç»†é…ç½®è¯·å‚è€ƒ**: [PRODUCTHUNT_CRON_ZEABUR.md](./PRODUCTHUNT_CRON_ZEABUR.md)

---

#### æ–¹æ¡ˆ B: Linux ç³»ç»Ÿ Cronï¼ˆä»…é€‚ç”¨äº VPS/ç‹¬ç«‹æœåŠ¡å™¨ï¼‰

âš ï¸ **æ³¨æ„**: ä»…å½“æ‚¨åœ¨ç‹¬ç«‹æœåŠ¡å™¨æˆ– VPS ä¸Šéƒ¨ç½²æ—¶ä½¿ç”¨æ­¤æ–¹æ¡ˆã€‚

**è‡ªåŠ¨å®‰è£…**:

```bash
cd /home/ivmm/Open-Launch
bash scripts/setup-cron.sh
```

**æ‰‹åŠ¨é…ç½®**:

```bash
# 1. è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™
chmod +x /home/ivmm/Open-Launch/scripts/cron-import-producthunt.sh

# 2. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cat > /home/ivmm/Open-Launch/.env.cron << 'EOF'
CRON_SECRET=your_cron_secret_here
API_URL=https://aat.ee
EOF

# 3. ç¼–è¾‘ crontab
crontab -e

# 4. æ·»åŠ å®šæ—¶ä»»åŠ¡
0 1 * * * source /home/ivmm/Open-Launch/.env.cron && /home/ivmm/Open-Launch/scripts/cron-import-producthunt.sh >> /home/ivmm/Open-Launch/logs/cron.log 2>&1
```

---

### æ­¥éª¤ 6: éªŒè¯é…ç½®

#### 6.1 æŸ¥çœ‹ Crontab

```bash
crontab -l
```

é¢„æœŸè¾“å‡ºï¼š

```
0 1 * * * source /home/ivmm/Open-Launch/.env.cron && /home/ivmm/Open-Launch/scripts/cron-import-producthunt.sh >> /home/ivmm/Open-Launch/logs/cron.log 2>&1
```

#### 6.2 æ‰‹åŠ¨æµ‹è¯•æ‰§è¡Œ

```bash
# æ‰‹åŠ¨è¿è¡Œè„šæœ¬
bash /home/ivmm/Open-Launch/scripts/cron-import-producthunt.sh
```

#### 6.3 æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f /home/ivmm/Open-Launch/logs/producthunt-import-*.log

# æŸ¥çœ‹ cron æ—¥å¿—
tail -f /home/ivmm/Open-Launch/logs/cron.log
```

**é¢„æœŸæ—¥å¿—è¾“å‡º**ï¼š

```
[2025-11-13 10:00:00] ==========================================
[2025-11-13 10:00:00] ğŸš€ Starting ProductHunt import cron job
[2025-11-13 10:00:00] ==========================================
[2025-11-13 10:00:00] ğŸ“ API URL: https://aat.ee
[2025-11-13 10:00:00] ğŸ“‚ Project root: /home/ivmm/Open-Launch
[2025-11-13 10:00:00] ğŸ“¡ Calling import API...
[2025-11-13 10:00:05] ğŸ“Š HTTP Status: 200
[2025-11-13 10:00:05] âœ… Import completed successfully
[2025-11-13 10:00:05] ğŸ“ˆ Summary: Imported=5, Skipped=0, Errors=0
```

---

## ğŸ“Š æ•°æ®æµè½¬è¯´æ˜

### 1. ProductHunt æ•°æ®è·å–

```typescript
// lib/producthunt.ts
const posts = await getTop5Posts()
// è¿”å›: id, name, tagline, description, url, votesCount, website, thumbnail, topics
```

### 2. æ•°æ®è½¬æ¢

```typescript
// é¡¹ç›®å­—æ®µæ˜ å°„
{
  name: post.name,                    // äº§å“åç§°
  slug: generateSlug(post.name),      // URL slug
  description: post.description,      // äº§å“æè¿°
  websiteUrl: post.website,           // å®˜ç½‘é“¾æ¥
  logoUrl: post.thumbnail.url,        // Logo å›¾ç‰‡
  techStack: extractTags(post.topics), // æ ‡ç­¾/å…³é”®è¯
  launchType: 'free',                 // å…è´¹å‘å¸ƒ
  launchStatus: 'scheduled',          // è®¡åˆ’å‘å¸ƒ
  scheduledLaunchDate: tomorrow,      // æ˜å¤©ä¸Šçº¿
}
```

### 3. Bot ç”¨æˆ·åˆ†é…

```typescript
// å¾ªç¯ä½¿ç”¨ 5 ä¸ª bot ç”¨æˆ·
const botUser = botUsers[i % botUsers.length]
// ç¬¬ 1 ä¸ªäº§å“ â†’ bot-user-ph-1
// ç¬¬ 2 ä¸ªäº§å“ â†’ bot-user-ph-2
// ...
// ç¬¬ 5 ä¸ªäº§å“ â†’ bot-user-ph-5
```

### 4. å¯¼å…¥è®°å½•

```typescript
// product_hunt_import è¡¨
{
  productHuntId: post.id,       // PH äº§å“ ID (ç”¨äºå»é‡)
  productHuntUrl: post.url,     // PH äº§å“é“¾æ¥
  projectId: projectId,         // aat.ee é¡¹ç›® ID
  votesCount: post.votesCount,  // æŠ•ç¥¨æ•°
  rank: 1-5,                    // å½“æ—¥æ’å
  importedAt: new Date()        // å¯¼å…¥æ—¶é—´
}
```

---

## ğŸ” å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: Cron Job æœªæ‰§è¡Œ

**ç—‡çŠ¶**: æ—¥å¿—æ–‡ä»¶ä¸­æ²¡æœ‰æ–°è®°å½•

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ cron æœåŠ¡çŠ¶æ€
sudo systemctl status cron

# 2. æ£€æŸ¥ crontab é…ç½®
crontab -l

# 3. æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
grep CRON /var/log/syslog | tail -20

# 4. æ‰‹åŠ¨æµ‹è¯•è„šæœ¬
bash /home/ivmm/Open-Launch/scripts/cron-import-producthunt.sh
```

**è§£å†³æ–¹æ¡ˆ**:

- âœ… ç¡®ä¿ cron æœåŠ¡è¿è¡Œ: `sudo systemctl start cron`
- âœ… éªŒè¯è„šæœ¬è·¯å¾„æ­£ç¡®
- âœ… æ£€æŸ¥æ–‡ä»¶æƒé™: `chmod +x scripts/cron-import-producthunt.sh`

---

### é—®é¢˜ 2: API è®¤è¯å¤±è´¥

**ç—‡çŠ¶**: HTTP 401 Unauthorized

**æ—¥å¿—ç¤ºä¾‹**:

```
âŒ Import failed with status code: 401
ğŸ“„ Response: {"error":"Unauthorized"}
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# 1. éªŒè¯ CRON_SECRET æ˜¯å¦åŒ¹é…
echo $CRON_SECRET

# 2. æ£€æŸ¥ .env.cron æ–‡ä»¶
cat /home/ivmm/Open-Launch/.env.cron

# 3. é‡æ–°ç”Ÿæˆå¯†é’¥
openssl rand -base64 32

# 4. æ›´æ–°ç¯å¢ƒå˜é‡ï¼ˆZeabur/Vercel + .env.cronï¼‰
```

---

### é—®é¢˜ 3: ProductHunt API é”™è¯¯

**ç—‡çŠ¶**: HTTP 500, "Failed to fetch ProductHunt data"

**æ—¥å¿—ç¤ºä¾‹**:

```
âŒ Failed to fetch ProductHunt posts: ProductHunt API error: 401
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# 1. æµ‹è¯• ProductHunt API Token
curl -H "Authorization: Bearer YOUR_TOKEN" \
     -H "Content-Type: application/json" \
     -X POST \
     -d '{"query": "{ viewer { id } }"}' \
     https://api.producthunt.com/v2/api/graphql

# 2. æ£€æŸ¥ Token æƒé™
# éœ€è¦ "public" è¯»å–æƒé™

# 3. æ£€æŸ¥ Rate Limit
# ProductHunt API é™åˆ¶: 100 è¯·æ±‚/å°æ—¶
```

---

### é—®é¢˜ 4: é‡å¤å¯¼å…¥

**ç—‡çŠ¶**: åŒä¸€ä¸ªäº§å“è¢«å¤šæ¬¡å¯¼å…¥

**æ’æŸ¥**:

```sql
-- æ£€æŸ¥é‡å¤è®°å½•
SELECT product_hunt_id, COUNT(*)
FROM product_hunt_import
GROUP BY product_hunt_id
HAVING COUNT(*) > 1;
```

**è§£å†³æ–¹æ¡ˆ**:

- âœ… ä»£ç å·²å®ç°å»é‡é€»è¾‘ï¼ˆé€šè¿‡ `product_hunt_id` å”¯ä¸€ç´¢å¼•ï¼‰
- âœ… å¦‚æœå‘ç°é‡å¤ï¼Œæ£€æŸ¥æ•°æ®åº“çº¦æŸæ˜¯å¦æ­£ç¡®åˆ›å»º

---

### é—®é¢˜ 5: æ²¡æœ‰ bot ç”¨æˆ·

**ç—‡çŠ¶**: "No bot users found in database"

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ–¹æ³• 1: è¿è¡Œç§å­è„šæœ¬
npx tsx scripts/seed-bot-users.ts

# æ–¹æ³• 2: æ‰‹åŠ¨æ‰§è¡Œ SQL
psql $DATABASE_URL < drizzle/migrations/add_bot_and_producthunt.sql

# æ–¹æ³• 3: æ‰‹åŠ¨åˆ›å»º
psql $DATABASE_URL -c "
INSERT INTO \"user\" (id, name, email, email_verified, created_at, updated_at, is_bot, role)
VALUES ('bot-user-ph-1', 'TechHunter', 'bot-ph-1@aat.ee', true, NOW(), NOW(), true, 'user')
ON CONFLICT (id) DO NOTHING;
"
```

---

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### 1. æ—¥å¿—è½®è½¬

```bash
# åˆ›å»ºæ—¥å¿—è½®è½¬é…ç½®
sudo nano /etc/logrotate.d/aat-producthunt

# æ·»åŠ ä»¥ä¸‹å†…å®¹
/home/ivmm/Open-Launch/logs/producthunt-import-*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
}

# æµ‹è¯•é…ç½®
sudo logrotate -d /etc/logrotate.d/aat-producthunt
```

### 2. å‘Šè­¦é…ç½®

```bash
# åˆ›å»ºå‘Šè­¦è„šæœ¬
cat > /home/ivmm/Open-Launch/scripts/check-import-status.sh << 'EOF'
#!/bin/bash
LOG_FILE=$(ls -t /home/ivmm/Open-Launch/logs/producthunt-import-*.log 2>/dev/null | head -1)
if [ -z "$LOG_FILE" ]; then
    echo "âŒ No log file found!"
    exit 1
fi

if grep -q "âŒ" "$LOG_FILE"; then
    echo "âš ï¸  Import errors detected!"
    grep "âŒ" "$LOG_FILE"
    exit 1
fi

echo "âœ… Import running normally"
exit 0
EOF

chmod +x /home/ivmm/Open-Launch/scripts/check-import-status.sh

# æ·»åŠ åˆ° crontabï¼ˆæ¯å¤©æ£€æŸ¥ï¼‰
# 0 2 * * * /home/ivmm/Open-Launch/scripts/check-import-status.sh || mail -s "PH Import Failed" admin@aat.ee
```

### 3. æ€§èƒ½ç›‘æ§

```sql
-- æŸ¥çœ‹å¯¼å…¥ç»Ÿè®¡
SELECT
    DATE(imported_at) as date,
    COUNT(*) as imported_count,
    AVG(votes_count) as avg_votes
FROM product_hunt_import
GROUP BY DATE(imported_at)
ORDER BY date DESC
LIMIT 30;

-- æŸ¥çœ‹æœ€è¿‘å¯¼å…¥çš„äº§å“
SELECT
    phi.rank,
    p.name,
    p.slug,
    phi.votes_count,
    phi.imported_at,
    u.name as bot_user
FROM product_hunt_import phi
JOIN project p ON phi.project_id = p.id
JOIN "user" u ON p.user_id = u.id
ORDER BY phi.imported_at DESC
LIMIT 20;
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. API å¯†é’¥ä¿æŠ¤

- âœ… æ°¸è¿œä¸è¦å°† API Key æäº¤åˆ° Git
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- âœ… å®šæœŸè½®æ¢ CRON_SECRET
- âœ… ä½¿ç”¨ `chmod 600` ä¿æŠ¤ `.env.cron` æ–‡ä»¶

### 2. Rate Limiting

```typescript
// ä»£ç ä¸­å·²å®ç°ï¼Œä½†å»ºè®®ç›‘æ§
// ProductHunt API Limit: 100 è¯·æ±‚/å°æ—¶
// æˆ‘ä»¬çš„ä½¿ç”¨: æ¯å¤© 1 æ¬¡è¯·æ±‚ï¼ˆè¿œä½äºé™åˆ¶ï¼‰
```

### 3. é”™è¯¯å¤„ç†

- âœ… API å¤±è´¥ä¸å½±å“ç°æœ‰æ•°æ®
- âœ… é‡å¤å¯¼å…¥è‡ªåŠ¨è·³è¿‡
- âœ… è¯¦ç»†é”™è¯¯æ—¥å¿—ä¾¿äºæ’æŸ¥

---

## ğŸ“ ç»´æŠ¤æ¸…å•

### æ¯æ—¥æ£€æŸ¥

- [ ] æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯¼å…¥æˆåŠŸ
- [ ] æ£€æŸ¥ç½‘ç«™æ˜¯å¦æœ‰æ–°äº§å“ä¸Šçº¿

### æ¯å‘¨æ£€æŸ¥

- [ ] æŸ¥çœ‹å¯¼å…¥ç»Ÿè®¡ï¼ˆæˆåŠŸç‡ï¼‰
- [ ] æ£€æŸ¥ bot ç”¨æˆ·æ˜¯å¦æ­£å¸¸
- [ ] æ¸…ç†è¿‡æœŸæ—¥å¿—

### æ¯æœˆæ£€æŸ¥

- [ ] å®¡æŸ¥ ProductHunt API ä½¿ç”¨é‡
- [ ] æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤å¯¼å…¥
- [ ] æ›´æ–°æ–‡æ¡£ï¼ˆå¦‚æœ‰å˜åŒ–ï¼‰

---

## ğŸš¨ ç´§æ€¥åœæ­¢

å¦‚éœ€åœæ­¢è‡ªåŠ¨å¯¼å…¥ï¼š

```bash
# æ–¹æ³• 1: ä¸´æ—¶ç¦ç”¨
crontab -e
# æ³¨é‡Šæ‰ç›¸å…³è¡Œï¼ˆæ·»åŠ  # å·ï¼‰

# æ–¹æ³• 2: å®Œå…¨ç§»é™¤
crontab -l | grep -v "cron-import-producthunt" | crontab -

# æ–¹æ³• 3: åœæ­¢ cron æœåŠ¡ï¼ˆä¸æ¨èï¼Œå½±å“å…¶ä»–ä»»åŠ¡ï¼‰
sudo systemctl stop cron
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **ç¯å¢ƒå˜é‡é…ç½®**: `env.example.txt`
- **æ•°æ®åº“è¿ç§»**: `drizzle/migrations/add_bot_and_producthunt.sql`
- **API å®¢æˆ·ç«¯**: `lib/producthunt.ts`
- **Cron ç«¯ç‚¹**: `app/api/cron/import-producthunt/route.ts`
- **Shell è„šæœ¬**: `scripts/cron-import-producthunt.sh`
- **å®‰è£…è„šæœ¬**: `scripts/setup-cron.sh`

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] å·²è·å– ProductHunt API Key
- [ ] å·²æ‰§è¡Œæ•°æ®åº“è¿ç§»
- [ ] å·²åˆ›å»º 5 ä¸ª bot ç”¨æˆ·
- [ ] å·²é…ç½®ç¯å¢ƒå˜é‡ï¼ˆPRODUCTHUNT_API_KEY, CRON_SECRETï¼‰
- [ ] å·²éƒ¨ç½²åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] å·²æ‰‹åŠ¨æµ‹è¯• API ç«¯ç‚¹æˆåŠŸ
- [ ] å·²é…ç½® Linux Cron Job
- [ ] å·²éªŒè¯ Cron Job è‡ªåŠ¨æ‰§è¡Œ
- [ ] å·²è®¾ç½®æ—¥å¿—ç›‘æ§
- [ ] å·²äº†è§£æ’æŸ¥æµç¨‹

---

**å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚** ğŸš€
